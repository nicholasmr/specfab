<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Structure tensors - specfab documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Structure tensors";
        var mkdocs_page_input_path = "cpo-structuretensors.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> specfab documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">CPO representation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-representation/">Representation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Structure tensors</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#convert-to-spectral">Convert to spectral</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#construct-from-measurements">Construct from measurements</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-idealized/">Idealized states</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-rotation/">Rotation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-plot/">Plotting</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CPO dynamics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-dynamics-tranisotropic/">Transversely isotropic grains</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-dynamics-orthotropic/">Orthotropic grains</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Viscous</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../enhancements-strainrate/">Strain-rate enhancements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../constitutive-viscoplastic/">Constitutive equations</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Elastic</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../wavepropagation-elastic/">Wave propagation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../constitutive-elastic/">Constitutive equations</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Electromagnetic</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../wavepropagation-electromagnetic/">Wave propagation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Further applications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../radar-derived-PP/">Radar-derived physical properties</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../FEM-integration-fenics/">FEniCS FEM integration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../FEM-integration-elmer/">Elmer FEM integration</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">specfab documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>CPO representation &raquo;</li>
      <li>Structure tensors</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="structure-tensors">Structure tensors</h1>
<p>The <span class="arithmatex">\(k\)</span>-th order structure tensor is the average <span class="arithmatex">\(k\)</span>-th repeated outer product of a crystallographic axis with itself (vector moments).
For example, in the case of a discrete ensemble of <span class="arithmatex">\({\bf c}\)</span> axes they are</p>
<div class="arithmatex">\[ 
{\bf a}^{(k)}=\frac{1}{N}\sum_i^N ({\bf c}_i\otimes)^k,
\]</div>
<p>where <span class="arithmatex">\(N\)</span> is the total number of grains, assuming equal grain weight (i.e. mass) for simplicity.
Alternatively, if the distribution function of <span class="arithmatex">\({\bf c}\)</span> axes is known, <span class="arithmatex">\(n(\theta,\phi)\)</span>, the structure tensors are</p>
<div class="arithmatex">\[ 
{\bf a}^{(k)}=\frac{1}{N} \int_{S^2} (\hat{{\bf r}}\otimes)^k n(\theta,\phi) \, \mathrm{d}\Omega
,
\]</div>
<p>where <span class="arithmatex">\(\mathrm{d}\Omega = \sin(\theta) \mathrm{d}\theta \mathrm{d}\phi\)</span> is the infinitesimal solid angle, <span class="arithmatex">\(\hat{{\bf r}}(\theta,\phi)\)</span> is the radial unit vector, and <span class="arithmatex">\(N=\int_{S^2} n(\theta,\phi) \, \mathrm{d}\Omega\)</span>.</p>
<h2 id="convert-to-spectral">Convert to spectral</h2>
<p>Converting between spectral and tensorial representations is a linear problem in the sense that </p>
<div class="arithmatex">\[
{\bf a}^{(k)} = {\bf f}(\hat{n}_2^{m}, \hat{n}_4^{m}, \cdots, \hat{n}_k^{m}) 
,
\qquad\text{(for all possible $m$)}
\]</div>
<p>where <span class="arithmatex">\({\bf f}\)</span> is linear in its arguments, and </p>
<div class="arithmatex">\[
\hat{n}_l^m = n_l^m/n_0^0
.
\]</div>
<p>In the case of <span class="arithmatex">\({\bf a}^{(2)}\)</span> the relation is simple:</p>
<div class="arithmatex">\[
{\bf a}^{(2)} = \frac{{\bf I}}{3} + \sqrt{\frac{2}{15}}
\left[\begin{matrix}
\operatorname{Re}[\hat{n}_2^2] - \dfrac{1}{2}\sqrt{\dfrac{2}{3}} \hat{n}_2^0 &amp; -\operatorname{Im}[\hat{n}_2^2] &amp; -\operatorname{Re}[\hat{n}_2^1] \\ 
 &amp; -\operatorname{Re}[\hat{n}_2^2] - \dfrac{1}{2}\sqrt{\dfrac{2}{3}} \hat{n}_2^0  &amp; \operatorname{Im}[\hat{n}_2^1] \\ 
\mathrm{sym.} &amp;  &amp; \sqrt{\dfrac{2}{3}} \hat{n}_2^0
\end{matrix}\right]
,
\]</div>
<p>but for higher-order structure tensors the expressions are long (not shown).</p>
<p>The following code example shows how to convert between the representations:</p>
<pre><code class="language-python">import numpy as np
from specfabpy import specfabpy as sf
L = 8
lm, nlm_len = sf.init(L)
nlm = np.zeros((nlm_len), dtype=np.complex64) # array of expansion coefficients

### a2 to nlm
a2 = np.diag([0.0,0.25,0.75]) # arbitrary second-order structure tensor
nlm[:sf.L2len] = sf.a2_to_nlm(a2) # determine l&lt;=2 expansion coefficients of ODF
a2 = sf.a2(nlm) # nlm back to a2
print('a2 is: ', a2)

### a4 to nlm
p = np.array([0,0,1]) # unidirectional CPO
a4 = np.einsum('i,j,k,l', p,p,p,p) # a4 for ODF = deltafunc(r-p) 
nlm[:sf.L4len] = sf.a4_to_nlm(a4) # determine l&lt;=4 expansion coefficients of ODF
a4 = sf.a4(nlm) # nlm back to a4 
print('a4 is: ', a4)

### a6 to nlm
p = np.array([0,0,1]) # unidirectional CPO
a6 = np.einsum('i,j,k,l,m,n', p,p,p,p,p,p) # a6 for ODF = deltafunc(r-p) 
nlm[:sf.L6len] = sf.a6_to_nlm(a6) # determine l&lt;=6 expansion coefficients of ODF
a6 = sf.a6(nlm) # nlm back to a6
print('a6 is: ', a6)
</code></pre>
<h2 id="construct-from-measurements">Construct from measurements</h2>
<p>The spectral expansion coefficients of any CPO may be determined from discrete measurements of crystallographic axes.
This requires constructing the corresponding structure tensors (for each crystallographic axis), from which the expansion coefficients may be derived.</p>
<pre><code class="language-python">import numpy as np
from specfabpy import specfabpy as sf
lm, nlm_len = sf.init(8) 

### Replace with your own array/list of measured c-axes
# caxes = [[c1x,c1y,c1z], [c2x,c2y,c2z], ...] 

### Determine sixth-order structure tensor, a6
a6 = np.zeros((3,3,3,3,3,3))
for c in caxes
    a6 += np.einsum('i,j,k,l,m,n', c,c,c,c,c,c) # sixth outer product of c-axis with itself
a6 /= len(caxes) # normalize by number of c-axes (grains)

### Determine spectral expansion coefficients
nlm = np.zeros((nlm_len), dtype=np.complex64) # array of expansion coefficients
nlm[:sf.L6len] = sf.a6_to_nlm(a6) # determine l&lt;=6 expansion coefficients of ODF 
</code></pre>
<p>Note that constructing <code>a6</code> is to be preferred over <code>a4</code> and <code>a2</code> since it contains more information on the fine-scale structure of the distribution; 
that is, <span class="arithmatex">\(l\leq 6\)</span> expansion coefficients as opposed to <span class="arithmatex">\(l\leq 4\)</span> and <span class="arithmatex">\(l\leq 2\)</span> coefficients, respectively.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../cpo-representation/" class="btn btn-neutral float-left" title="Representation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../cpo-idealized/" class="btn btn-neutral float-right" title="Idealized states">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../cpo-representation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cpo-idealized/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
