<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Lattice rotation - specfab documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Lattice rotation";
        var mkdocs_page_input_path = "lattice-rotation.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> specfab documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">üìñ About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../install/">üì¶ Install</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">üíé CPO representation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-representation/">Representation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-structuretensors/">Structure tensors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-idealized/">Idealized CPO states</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">‚öôÔ∏è CPO Dynamics</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-matrix-model/">Matrix model</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Lattice rotation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#directors-method">Directors method</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#matrix-model">Matrix model</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#code-example">Code example</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../recrystallization-DDRX/">Discontinous DRX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../recrystallization-CDRX/">Continous DRX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-regularization/">Regularization</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üåÄ Viscosity</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../enhancements-strainrate/">Strain-rate enhancement</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enhancements-strainrate-ice/">Glacier ice</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enhancements-strainrate-olivine/">Olivine</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üåä Wave propagation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../wavepropagation-elastic/">Elastic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wavepropagation-electromagnetic/">Electromagnetic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üñºÔ∏è Application Gallery</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-SSA-fabric-solver/">Steady SSA CPO field</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-CPO-from-radar/">Inferring CPO from radar</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-CPO-flow-coupling/">Coupling flow and CPO</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-Lagrangian-parcel/">Lagrangian parcel model</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üß© Miscellaneous</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../deformation-kinematics/">Deformation kinematics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-plot/">Plot CPO</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-rotation/">Rotate CPO</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../constitutive-viscoplastic/">Viscoplastic constitutive eqns.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../constitutive-elastic/">Elastic constitutive eqns.</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">specfab documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>‚öôÔ∏è CPO Dynamics &raquo;</li>
      <li>Lattice rotation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="lattice-rotation">Lattice rotation</h1>
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/images/slip-plane/plastic-spin.png" style="width:320px" /></p>
<p>When subject to simple shear, the orientation of easy slip systems in polycrystalline materials like ice or olivine tend towards aligning with the bulk shear-plane system. 
That is, the <span class="arithmatex">\(n\)</span>-axis (<span class="arithmatex">\(c\)</span>-axis in ice) tends towards to bulk shear plane normal, and the <span class="arithmatex">\(b\)</span>-axis (<span class="arithmatex">\(a\)</span>-axis in ice) towards to bulk shear direction.
Thus, if grains are perfectly aligned with the bulk shear system, their orientation should be unaffected by any further shearing, but be in steady state.
Clearly, slip systems do therefore not simply co-rotate with the bulk continuum spin (<span class="arithmatex">\({\boldsymbol \omega}\)</span>) like passive material line elements embedded in a flow field, i.e. 
<span class="arithmatex">\({\bf \dot{n}} \neq {\boldsymbol \omega} \cdot {\bf n}\)</span>.
Rather, slip systems must be subject to an additional contribution &mdash; a plastic spin <span class="arithmatex">\({\boldsymbol\omega}'\)</span> &mdash; such that the bulk spin is exactly counteracted to achieve steady state if favorably aligned:</p>
<!-- \quad\text{for ${\bf b}$&ndash;${\bf n}$ shear}. -->
<div class="arithmatex">\[
{\bf \dot{n}} = ({\boldsymbol\omega} + {\boldsymbol\omega}'_\mathrm{n}) \cdot {\bf n} = {\bf 0} , 
\]</div>
<div class="arithmatex">\[
{\bf \dot{b}} = ({\boldsymbol\omega} + {\boldsymbol\omega}'_\mathrm{b}) \cdot {\bf b} = {\bf 0} .
\]</div>
<p>More precisely, the crystallographic axes reorient themselves in response to both the bulk continuum spin and a plastic spin that is supposed to represent the crystallographic spin needed to accommodate strain compatibility between grains that otherwise preferentially deform by easy slip (i.e., basal slip for ice).</p>
<h2 id="directors-method">Directors method</h2>
<p><a href="https://doi.org/10.1016/0749-6419(91)90028-W">Aravas and Aifantis (1991)</a> and <a href="https://www.doi.org/10.1088/0965-0393/2/3A/005">Aravas (1994)</a> (among others) proposed a particularly simple model for the functional form of <span class="arithmatex">\({\boldsymbol \omega}'\)</span>, the so-called directors method.</p>
<p>For a constant rate of shear deformation (<span class="arithmatex">\(1/\tau\)</span>) aligned with the <span class="arithmatex">\({\bf b}\)</span>&mdash;<span class="arithmatex">\({\bf n}\)</span> system, the deformation gradient is <span class="arithmatex">\({\bf F} = {\bf I} + (t/\tau) {\bf b}{\bf n}\)</span> and therefore </p>
<div class="arithmatex">\[
\nabla {\bf u} = \frac{1}{\tau} {\bf b}{\bf n}
\quad \Longrightarrow\quad
{\dot{\boldsymbol\epsilon}} = \frac{1}{2\tau} ({\bf b}{\bf n} + {\bf n}{\bf b}),
\quad
{\boldsymbol \omega} = \frac{1}{2\tau} ({\bf b}{\bf n} - {\bf n}{\bf b}) .
\]</div>
<p>Since <span class="arithmatex">\({\boldsymbol \omega}' = -{\boldsymbol \omega}\)</span> is required in steady state, it follows from eliminating <span class="arithmatex">\(1/(2\tau)\)</span> by calculating 
<span class="arithmatex">\({\dot{\boldsymbol\epsilon}} \cdot {\bf n}^2\)</span>, 
<span class="arithmatex">\({\bf n}^2 \cdot {\dot{\boldsymbol\epsilon}}\)</span>, 
<span class="arithmatex">\({\dot{\boldsymbol\epsilon}} \cdot {\bf b}^2\)</span>, and 
<span class="arithmatex">\({\bf b}^2 \cdot {\dot{\boldsymbol\epsilon}}\)</span>, 
that</p>
<div class="arithmatex">\[
{\boldsymbol \omega}'_\mathrm{n} = +{\bf n}^2 \cdot {\dot{\boldsymbol\epsilon}} - {\dot{\boldsymbol\epsilon}} \cdot {\bf n}^2 ,
\\
{\boldsymbol \omega}'_\mathrm{b} = -{\bf b}^2 \cdot {\dot{\boldsymbol\epsilon}} + {\dot{\boldsymbol\epsilon}} \cdot {\bf b}^2 .
\]</div>
<p>Indeed, this result agrees with representation theorems for isotropic functions (Wang, 1969), stating that an antisymmetric tensor-valued function of a symmetric tensor (<span class="arithmatex">\({\dot{\boldsymbol\epsilon}}\)</span>) and a vector (<span class="arithmatex">\({\hat {\bf r}}\)</span>) is to lowest order given by</p>
<div class="arithmatex">\[
{\boldsymbol \omega}' = 
\iota({\hat {\bf r}}^2\cdot{\dot{\boldsymbol\epsilon}} - {\dot{\boldsymbol\epsilon}}\cdot{\hat {\bf r}}^2)
.
\]</div>
<p>To be consistent with the above, <span class="arithmatex">\(\iota = +1\)</span> for <span class="arithmatex">\({\hat {\bf r}}={\bf n}\)</span> and <span class="arithmatex">\(\iota = -1\)</span> for <span class="arithmatex">\({\hat {\bf r}}={\bf b}\)</span>.</p>
<p><span class="arithmatex">\({\boldsymbol \omega}'_\mathrm{n}\)</span> and <span class="arithmatex">\({\boldsymbol \omega}'_\mathrm{b}\)</span> are then generally taken to suffice for other deformation kinematics, too.</p>
<div class="admonition note">
<p class="admonition-title">Glacier ice</p>
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/images/tranisotropic/plastic-spin.png" style="width:330px" /></p>
<p>The predicted normalized <span class="arithmatex">\(c\)</span>-axis velocity field for glacier ice where <span class="arithmatex">\({\bf n} = {\bf c}\)</span> is show below for three different deformation kinematics:</p>
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/images/deformation-modes/deformation-modes.png#center" style="width:550px" /></p>
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/demo/latrot-velocity/latrot-velocity.png" style="width:560px" /></p>
</div>
<h3 id="matrix-model">Matrix model</h3>
<p>The corresponding effect on the continuous distribution functions is modelled as a conservative advection process in orientation space <span class="arithmatex">\(S^2\)</span>:</p>
<div class="arithmatex">\[ 
\frac{\mathrm{D} n}{\mathrm{D} t} = -\nabla_{S^2}\cdot(n{\bf \dot{n}}) 
\quad\Longrightarrow\quad
\frac{\mathrm{D} {\bf s}_n}{\mathrm{D} t} = {\bf M_{\mathrm{LROT}}}(\iota=+1) \cdot {\bf s}_n,
\]</div>
<div class="arithmatex">\[ 
\frac{\mathrm{D} b}{\mathrm{D} t} = -\nabla_{S^2}\cdot(b{\bf \dot{b}}) 
\quad\Longrightarrow\quad
\frac{\mathrm{D} {\bf s}_b}{\mathrm{D} t} = {\bf M_{\mathrm{LROT}}}(\iota=-1) \cdot {\bf s}_b,
\]</div>
<p>where <span class="arithmatex">\({\bf M_{\mathrm{LROT}}}(\iota)\)</span> is given analytically in <a href="https://doi.org/10.1017/jog.2020.117">Rathmann et al. (2021)</a>.</p>
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/demo/fabric-evolution/animation-LROT.gif" style="width:610px" /></p>
<h3 id="code-example">Code example</h3>
<pre><code class="language-python">import numpy as np
from specfabpy import specfab as sf
# L=8 truncation is sufficient in this case, but larger L allows a very strong fabric to  
#  develop and minimizes the effect that regularization has on low wavenumber modes (l=2,4)
lm, nlm_len = sf.init(8) 

### Velocity gradient tensor experienced by parcel

ugrad = np.diag([0.5, 0.5, -1.0]) # uniaxial compression along z-axis
D = (ugrad+np.transpose(ugrad))/2 # symmetric part (strain rate tensor)
W = (ugrad-np.transpose(ugrad))/2 # anti-symmetric part (spin tensor)

### Numerics 

Nt = 25   # number of time steps
dt = 0.05 # time-step size

### Initial fabric state

nlm = np.zeros((Nt,nlm_len), dtype=np.complex64) # n state vector
nlm[0,0] = 1/np.sqrt(4*np.pi) # normalized isotropic state at t=0

### Euler integration

for tt in np.arange(1,Nt):
    nlm_prev = nlm[tt-1,:] # previous solution
    iota, zeta = 1, 0      # &quot;deck of cards&quot; behavior 
    M_LROT = sf.M_LROT(nlm_prev, D, W, iota, zeta) # lattice rotation operator
    M_REG  = sf.M_REG(nlm_prev, D)                 # regularization operator
    M      = M_LROT + M_REG
    nlm[tt,:] = nlm_prev + dt*np.matmul(M, nlm_prev) # euler step
    nlm[tt,:] = sf.apply_bounds(nlm[tt,:]) # apply spectral bounds if needed
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../cpo-matrix-model/" class="btn btn-neutral float-left" title="Matrix model"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../recrystallization-DDRX/" class="btn btn-neutral float-right" title="Discontinous DRX">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../cpo-matrix-model/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../recrystallization-DDRX/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
