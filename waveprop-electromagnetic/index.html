<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Electromagnetic - specfab documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Electromagnetic";
        var mkdocs_page_input_path = "waveprop-electromagnetic.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> specfab documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">üìñ About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../install/">üì¶ Install</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">üíé CPO representation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-representation/">Representation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-structuretensors/">Structure tensors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-statespace/">State space</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">‚öôÔ∏è CPO Dynamics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../fabdyn-matrix-model/">Matrix model</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fabdyn-LROT/">Lattice rotation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fabdyn-DDRX/">Discontinous DRX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fabdyn-CDRX/">Continous DRX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fabdyn-REG/">Regularization</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üåÄ Viscosity</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../enhancements-strainrate/">Strain-rate enhancement</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enhancements-strainrate-ice/">Glacier ice</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enhancements-strainrate-olivine/">Olivine</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üåä Wave propagation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../waveprop-elastic/">Elastic</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Electromagnetic</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#homogenization">Homogenization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#glacier-ice">Glacier ice</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#travel-time-difference">Travel time difference</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#code-example">üìù Code example</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üñºÔ∏è Application Gallery</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-Lagrangian-CPO-parcel/">Lagrangian CPO parcel</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-Eulerian-CPO-field/">Eulerian CPO field</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-CPO-from-radar/">Inferring CPO from radar</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gallery-CPO-flow-coupling/">Coupling CPO and flow</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üß© Miscellaneous</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../deformation-kinematics/">Deformation kinematics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-plot/">Plot CPO</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cpo-rotation/">Rotate CPO</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../constitutive-viscoplastic/">Viscoplastic constitutive eqns.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../constitutive-elastic/">Elastic constitutive eqns.</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">specfab documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>üåä Wave propagation &raquo;</li>
      <li>Electromagnetic</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="electromagnetic-wave-propagation">Electromagnetic wave propagation</h1>
<p>Plane waves are a well-known solution to Maxwell's equations in a non-conducting, source-free, anisotropic linear dielectric medium</p>
<div class="arithmatex">\[
\nabla \times \nabla \times {\bf E} = -\mu {\boldsymbol \epsilon} \frac{\partial^2 {\bf E}}{\partial t^2},
\]</div>
<!--Note this can also be written as $\nabla^2 {\bf E} = \mu {\boldsymbol \epsilon} {\partial^2 {\bf E}}/{\partial t^2}$.-->
<p>where <span class="arithmatex">\({\bf E}\)</span> is the electric field, <span class="arithmatex">\({\boldsymbol \epsilon}\)</span> is the bulk dielectric permittivity tensor, and <span class="arithmatex">\(\mu\)</span> the bulk isotropic permeability of the medium.
Substituting <span class="arithmatex">\({\bf E}\)</span> for the plane wave solution, <span class="arithmatex">\({\bf E} = {\bf E}_0 \exp[i({\bf k}\cdot {\bf x} - \omega t)]\)</span>, the problem reduces to</p>
<div class="arithmatex">\[
({\bf K} + \omega^2 \mu {\boldsymbol \epsilon}) \cdot {\bf E} = {\bf 0},
\]</div>
<p>where <span class="arithmatex">\({\bf K} = {\bf k}\times{\bf k} \times\)</span> is the <a href="https://en.wikipedia.org/wiki/Cross_product#Alternative_ways_to_compute">matrix representation</a> of the twice-applied cross product.
The above equation implies that <span class="arithmatex">\(\det( {\bf K} + \omega^2 \mu {\boldsymbol \epsilon} ) = 0\)</span>. Hence, the eigenvalues and eigenvectors of the normalized Christoffel tensor <span class="arithmatex">\({\boldsymbol \epsilon}^{-1} {\bf K}/(\mu k^2)\)</span> are the permitted wave velocities squared <span class="arithmatex">\(V^2 = {\omega^2}/{k^2}\)</span> and wave polarization, respectively.</p>
<h2 id="homogenization">Homogenization</h2>
<p>If wave lengths are much longer than the average grain size, the problem can be closed by approximating the bulk polycrystalline permittivity tensor by the grain-averaged permittivity tensor</p>
<div class="arithmatex">\[{\boldsymbol \epsilon} = \langle {\boldsymbol \epsilon}' \rangle,\]</div>
<p>constructed by averaging over all grain orientations (over the CPO).</p>
<hr />
<h2 id="glacier-ice">Glacier ice</h2>
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/images/tranisotropic/monoice-dielectric.png" style="width:150px" /></p>
<p>If ice grains are approximated as transversely isotropic w.r.t. the <span class="arithmatex">\(c\)</span>-axis, the dielectric permittivity tensor of a single crystal can be written as
$$
{\boldsymbol \epsilon}' =  (2\epsilon_{a}' + \epsilon_{c}') \frac{\bf I}{3}
+ (\epsilon_{c}'-\epsilon_{a}') \left( {\bf c}^2 - \frac{\bf I}{3} \right),
$$
where <span class="arithmatex">\(\epsilon_{c}'\)</span> and <span class="arithmatex">\(\epsilon_{a}'\)</span> are the permittivities parallel and perpendicular to the <span class="arithmatex">\(c\)</span> axis.
In this case, the grain-averaged permitivity is simply </p>
<div class="arithmatex">\[
\langle {\boldsymbol \epsilon}'\rangle = (2\epsilon_{a}' + \epsilon_{c}') \frac{\bf I}{3}
+ (\epsilon_{c}'-\epsilon_{a}') \left( \langle {\bf c}^2 \rangle - \frac{\bf I}{3} \right)
,
\]</div>
<p>where <span class="arithmatex">\(\langle {\bf c}^2 \rangle\)</span> is the <a href="../cpo-structuretensors/">second-order structure tensor</a>.</p>
<h3 id="travel-time-difference">Travel time difference</h3>
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/images/waveprop/radioglac.png" style="width:550px" /></p>
<p>Radioglaciological field surveys are a popular approach for understanding the depth-averaged CPOs of ice sheets and glaciers. 
Such surveys rely on the fact that orthogonally polarized radio waves travel at different speeds depending on the misalignment between wave polarization and the CPO principal axes (birefringence). 
Thus, if travel-time delays can be measured accurately for orthogonally polarized waves, inferences about the CPOs  of glaciers and ice sheets can be made.</p>
<p>To realize how, consider a frame where the CPO principal axes are aligned with the Cartesian coordinate system so that <span class="arithmatex">\(\langle {\bf c}^2 \rangle = \operatorname{diag}(\lambda_x,\lambda_y,\lambda_z)\)</span>. 
It can be shown that two S-wave solutions exist for the above eigenvalue problem that have the distinct slownesses (inverse velocities) 
$$
S_i^2 = S_a^2 + \lambda_i \Delta S^2 
$$
when (eigen)polarized along the <span class="arithmatex">\({\bf x}\)</span>- and <span class="arithmatex">\({\bf y}\)</span>-axis (<span class="arithmatex">\(i=x,y\)</span>). Here, <span class="arithmatex">\(S_c=\mu\epsilon'_c\)</span> and <span class="arithmatex">\(S_a=\mu\epsilon'_a\)</span> are the monocrystal slownesses for waves polarized along the <span class="arithmatex">\({\bf c}\)</span> and <span class="arithmatex">\({\bf a}\)</span> axes of a single crystal, and <span class="arithmatex">\(\Delta S=S^2_c - S^2_a\)</span> is the squared monocrystal slowness anisotropy.</p>
<p>The two-way travel time difference between eigenpolarized waves, propagating from the surface at height <span class="arithmatex">\(H\)</span> to a depth of <span class="arithmatex">\(z\)</span>, and back, is</p>
<p>$$
\Delta t(z) = t_x(z) - t_y(z) = 2 \int_z^H S_x(z') \,\mathrm{d}{z'} - 2\int_z^H S_y(z') \,\mathrm{d}{z'} .
$$
Expanding the depth-depedent slowness 
$$
S_i(z) = \sqrt{S_a^2 + \lambda_i(z) \Delta S^2 }
$$
around the isotropic state <span class="arithmatex">\(\lambda_i=1/3\)</span>, it can be shown that 
$$
\Delta t(z) \simeq \frac{\Delta S^2}{S_{\mathrm{iso}}} \int_z^H (\lambda_x(z')-\lambda_y(z')) \,\mathrm{d}{z'}, 
$$
where <span class="arithmatex">\(S_{\mathrm{iso}}=\sqrt{\mu(2\epsilon'_a+\epsilon'_c)/3}\)</span> is the slowness within an isotropic polycrystal. </p>
<p>Thus, the travel time difference between vertically-propagating eigenpolarized waves is (approximately) proportional to the depth-integrated difference in horizontal eigenvalues.</p>
<h3 id="code-example">üìù Code example</h3>
<div style="float: left; width: 48%;">
<p>A code example is given below of how to calculate EM wave velocities using <em>specfab</em>. 
Notice that the problem depends on the <em>relative</em> permitivity and permeability, and that wave propagation is sensitive only the the lowest-order (coarsets degree) of CPO anisotropy, <span class="arithmatex">\(\langle {\bf c}^2 \rangle\)</span>.</p>
<p>The animation to the right shows directional S-wave velocities for a CPO evolving under <a href="../deformation-kinematics/"><span class="arithmatex">\(xz\)</span> confined compression</a>, relative to an isotropic CPO, when subject to <a href="../fabdyn-LROT/">lattice rotation</a>.</p>
</div>
<div style="float: right; width: 50%;">
<p><img alt="" src="https://raw.githubusercontent.com/nicholasmr/specfab/main/demo/cube-crush-animation/S2-maps/S2-vi-EM.gif" style="width:430px" /></p>
</div>
<div style="clear: both;"></div>
<pre><code class="language-python">import numpy as np
from specfabpy import specfab as sf
lm, nlm_len = sf.init(4)
nlm = np.zeros((nlm_len), dtype=np.complex64) # state vector (array of expansion coefficients)

### Physical parameters (note eps=eps0*epsr, mu=mu0*mur)
epsr_c = 3.17        # relative permittivity of a single grain parallel to symmetry axis (c) 
epsr_a = 3.17-0.034  # relative permittivity of a single grain perpendicular to symmetry axis (a)
mur = 1              # relative permeability of a single grain

### CPO from second-order structure tensor
p = np.array([0,0,1]) # preferred c-axis direction
a2 = np.einsum('i,j', p,p) # = deltafunc(r-p) 
nlm[:sf.L2len] = sf.a2_to_nlm(a2) # l&lt;=2 expansion coefficients

### Propagation directions of interest
theta, phi = np.deg2rad([0,90,]), np.deg2rad([0,0,]) # theta=colatitude, phi=longitude

### Calculate phase velocities
Vi = sf.Vi_electromagnetic_tranisotropic(nlm, epsr_c, epsr_a, mur, theta,phi) # fast and slow phase velocities are V_S1=vi[0,:], V_S2=vi[1,:]
</code></pre>
<!--
- - -

## Olivine

üöß *Not yet supported.*

-->
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../waveprop-elastic/" class="btn btn-neutral float-left" title="Elastic"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../gallery-Lagrangian-CPO-parcel/" class="btn btn-neutral float-right" title="Lagrangian CPO parcel">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../waveprop-elastic/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../gallery-Lagrangian-CPO-parcel/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
